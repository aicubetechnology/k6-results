{"openapi":"3.1.0","info":{"title":"Memória Neural do Qube","description":"API para armazenamento e recuperação de contexto em tempo real para agentes LLM","version":"0.1.0"},"paths":{"/health":{"get":{"tags":["Administração"],"summary":"Health Check","description":"Verifica a saúde do serviço.","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"}}}}}}},"/memorize":{"post":{"tags":["Memória"],"summary":"Memorize","description":"Armazena uma nova memória no sistema.","operationId":"memorize_memorize_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MemorizeRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MemorizeResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/memorize_batch":{"post":{"tags":["Memória"],"summary":"Memorize Batch","description":"Armazena múltiplas memórias em batch.","operationId":"memorize_batch_memorize_batch_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MemorizeBatchRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/MemorizeResponse"},"type":"array","title":"Response Memorize Batch Memorize Batch Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/retrieve":{"post":{"tags":["Memória"],"summary":"Retrieve","description":"Recupera memórias relevantes com base em uma consulta.","operationId":"retrieve_retrieve_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RetrieveRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RetrieveResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/memory/{memory_id}":{"get":{"tags":["Memória"],"summary":"Get Memory","description":"Recupera detalhes de uma memória específica.","operationId":"get_memory_memory__memory_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"memory_id","in":"path","required":true,"schema":{"type":"string","description":"ID da memória","title":"Memory Id"},"description":"ID da memória"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MemoryDetailResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Memória"],"summary":"Delete Memory","description":"Remove uma memória específica.","operationId":"delete_memory_memory__memory_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"memory_id","in":"path","required":true,"schema":{"type":"string","description":"ID da memória","title":"Memory Id"},"description":"ID da memória"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/forget":{"post":{"tags":["Administração"],"summary":"Trigger Forget Gate","description":"Aciona manualmente o mecanismo de forget gate para um tenant.","operationId":"trigger_forget_gate_admin_forget_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgetRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgetResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/admin/tenant/{tenant_id}/stats":{"get":{"tags":["Administração"],"summary":"Get Tenant Stats","description":"Obtém estatísticas sobre as memórias de um tenant.","operationId":"get_tenant_stats_admin_tenant__tenant_id__stats_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","description":"ID do tenant","title":"Tenant Id"},"description":"ID do tenant"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantStatsResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/tenant/register":{"post":{"tags":["Administração"],"summary":"Register Tenant","description":"Registra um novo tenant no sistema.\nObservação: Na prática, este endpoint teria autenticação adicional de nível admin.","operationId":"register_tenant_admin_tenant_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantRegisterRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantRegisterResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"ForgetRequest":{"properties":{"tenant_id":{"type":"string","title":"Tenant Id","description":"Identificador do tenant"},"decay_factor":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Decay Factor","description":"Fator de decaimento (0-1)"},"threshold":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Threshold","description":"Limiar mínimo de importância (0-1)"}},"type":"object","required":["tenant_id"],"title":"ForgetRequest","description":"Modelo para requisição de forget gate."},"ForgetResponse":{"properties":{"status":{"type":"string","title":"Status","description":"Status da operação"},"tenant_id":{"type":"string","title":"Tenant Id","description":"ID do tenant"},"memories_removed":{"type":"integer","title":"Memories Removed","description":"Número de memórias removidas"},"decay_factor":{"type":"number","title":"Decay Factor","description":"Fator de decaimento aplicado"},"threshold":{"type":"number","title":"Threshold","description":"Limiar mínimo aplicado"},"elapsed_time":{"type":"number","title":"Elapsed Time","description":"Tempo de execução em segundos"}},"type":"object","required":["status","tenant_id","memories_removed","decay_factor","threshold","elapsed_time"],"title":"ForgetResponse","description":"Modelo para resposta de forget gate."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"HealthResponse":{"properties":{"status":{"type":"string","title":"Status","description":"Status do serviço"},"version":{"type":"string","title":"Version","description":"Versão do serviço"},"gpus":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Gpus","description":"Informações sobre GPUs disponíveis"},"timestamp":{"type":"string","title":"Timestamp","description":"Timestamp da verificação"}},"type":"object","required":["status","version","gpus","timestamp"],"title":"HealthResponse","description":"Modelo para resposta do endpoint de saúde."},"MemorizeBatchRequest":{"properties":{"tenant_id":{"type":"string","title":"Tenant Id","description":"Identificador do tenant"},"agent_id":{"type":"string","title":"Agent Id","description":"Identificador do agente"},"task_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Task Id","description":"Identificador da tarefa (opcional)"},"texts":{"items":{"type":"string"},"type":"array","title":"Texts","description":"Lista de conteúdos a memorizar"},"metadatas":{"anyOf":[{"items":{"additionalProperties":true,"type":"object"},"type":"array"},{"type":"null"}],"title":"Metadatas","description":"Lista de metadados (opcional)"}},"type":"object","required":["tenant_id","agent_id","texts"],"title":"MemorizeBatchRequest","description":"Modelo para requisição de memorização em batch."},"MemorizeRequest":{"properties":{"tenant_id":{"type":"string","title":"Tenant Id","description":"Identificador do tenant"},"agent_id":{"type":"string","title":"Agent Id","description":"Identificador do agente"},"task_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Task Id","description":"Identificador da tarefa (opcional)"},"text":{"type":"string","title":"Text","description":"Conteúdo a memorizar"},"metadata":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Metadata","description":"Metadados adicionais"}},"type":"object","required":["tenant_id","agent_id","text"],"title":"MemorizeRequest","description":"Modelo para requisição de memorização."},"MemorizeResponse":{"properties":{"status":{"type":"string","title":"Status","description":"Status da operação"},"memory_id":{"type":"string","title":"Memory Id","description":"ID da memória armazenada"},"surprise_score":{"type":"number","title":"Surprise Score","description":"Score de surpresa/novidade calculado"},"stored_at":{"type":"string","title":"Stored At","description":"Timestamp de armazenamento"}},"type":"object","required":["status","memory_id","surprise_score","stored_at"],"title":"MemorizeResponse","description":"Modelo para resposta de memorização."},"MemoryDetailResponse":{"properties":{"memory_id":{"type":"string","title":"Memory Id","description":"ID da memória"},"tenant_id":{"type":"string","title":"Tenant Id","description":"ID do tenant"},"agent_id":{"type":"string","title":"Agent Id","description":"ID do agente"},"task_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Task Id","description":"ID da tarefa"},"content":{"type":"string","title":"Content","description":"Conteúdo da memória"},"metadata":{"additionalProperties":true,"type":"object","title":"Metadata","description":"Metadados da memória"},"importance":{"type":"number","title":"Importance","description":"Score de importância"},"created_at":{"type":"string","title":"Created At","description":"Data de criação"},"last_access":{"type":"string","title":"Last Access","description":"Data do último acesso"}},"type":"object","required":["memory_id","tenant_id","agent_id","content","metadata","importance","created_at","last_access"],"title":"MemoryDetailResponse","description":"Modelo para resposta detalhada de uma memória específica."},"MemoryMatch":{"properties":{"memory_id":{"type":"string","title":"Memory Id","description":"ID da memória"},"text":{"type":"string","title":"Text","description":"Conteúdo da memória"},"score":{"type":"number","title":"Score","description":"Score de similaridade"},"metadata":{"additionalProperties":true,"type":"object","title":"Metadata","description":"Metadados da memória"},"agent_id":{"type":"string","title":"Agent Id","description":"ID do agente que criou a memória"},"task_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Task Id","description":"ID da tarefa associada"}},"type":"object","required":["memory_id","text","score","metadata","agent_id"],"title":"MemoryMatch","description":"Modelo para um resultado de memória encontrado."},"RetrieveRequest":{"properties":{"tenant_id":{"type":"string","title":"Tenant Id","description":"Identificador do tenant"},"agent_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Agent Id","description":"Identificador do agente (opcional)"},"task_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Task Id","description":"Identificador da tarefa (opcional)"},"query":{"type":"string","title":"Query","description":"Texto de consulta"},"top_k":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Top K","description":"Número máximo de resultados a retornar","default":5},"filters":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Filters","description":"Filtros adicionais (opcional)"},"include_query_embedding":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Include Query Embedding","description":"Incluir embedding da consulta na resposta","default":false}},"type":"object","required":["tenant_id","query"],"title":"RetrieveRequest","description":"Modelo para requisição de recuperação de memórias."},"RetrieveResponse":{"properties":{"matches":{"items":{"$ref":"#/components/schemas/MemoryMatch"},"type":"array","title":"Matches","description":"Lista de memórias encontradas"},"source":{"type":"string","title":"Source","description":"Fonte dos resultados (cache ou vector_db)"},"query_embedding":{"anyOf":[{"items":{"type":"number"},"type":"array"},{"type":"null"}],"title":"Query Embedding","description":"Embedding da consulta (opcional)"}},"type":"object","required":["matches","source"],"title":"RetrieveResponse","description":"Modelo para resposta de recuperação."},"TenantRegisterRequest":{"properties":{"tenant_id":{"type":"string","title":"Tenant Id","description":"ID do tenant"},"name":{"type":"string","title":"Name","description":"Nome do tenant"},"quota_max_memories":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Quota Max Memories","description":"Quota máxima de memórias","default":10000},"quota_max_requests_per_day":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Quota Max Requests Per Day","description":"Quota máxima de requisições por dia","default":1000}},"type":"object","required":["tenant_id","name"],"title":"TenantRegisterRequest","description":"Modelo para requisição de registro de tenant."},"TenantRegisterResponse":{"properties":{"tenant_id":{"type":"string","title":"Tenant Id","description":"ID do tenant"},"name":{"type":"string","title":"Name","description":"Nome do tenant"},"api_key":{"type":"string","title":"Api Key","description":"API key gerada"},"quota_max_memories":{"type":"integer","title":"Quota Max Memories","description":"Quota máxima de memórias"},"quota_max_requests_per_day":{"type":"integer","title":"Quota Max Requests Per Day","description":"Quota máxima de requisições por dia"}},"type":"object","required":["tenant_id","name","api_key","quota_max_memories","quota_max_requests_per_day"],"title":"TenantRegisterResponse","description":"Modelo para resposta de registro de tenant."},"TenantStatsResponse":{"properties":{"total_memories":{"type":"integer","title":"Total Memories","description":"Total de memórias armazenadas"},"avg_importance":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Avg Importance","description":"Importância média das memórias"},"oldest_memory":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Oldest Memory","description":"Data da memória mais antiga"},"newest_memory":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Newest Memory","description":"Data da memória mais recente"},"agent_count":{"type":"integer","title":"Agent Count","description":"Número de agentes distintos"},"agent_distribution":{"additionalProperties":{"type":"integer"},"type":"object","title":"Agent Distribution","description":"Distribuição de memórias por agente"},"average_tenant_surprise":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Average Tenant Surprise","description":"Surpresa média do tenant"},"agents_surprise":{"anyOf":[{"additionalProperties":{"type":"number"},"type":"object"},{"type":"null"}],"title":"Agents Surprise","description":"Surpresa por agente"}},"type":"object","required":["total_memories","agent_count","agent_distribution"],"title":"TenantStatsResponse","description":"Modelo para estatísticas de um tenant."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"HTTPBearer":{"type":"http","scheme":"bearer"}}}}